{
    "id": "teams",
    "name": "Microsoft Teams",
    "description": "Microsoft Teams helps your team work better together. It brings your team's conversations, meetings, files, and notes together to enable open and seamless collaboration.",
    "externalConfiguration": {
      "createSubscriptionUrl": "https://go.microsoft.com/fwlink/?linkid=832347",
      "hostedOnly": true
    },
    "imageUrl": "",
    "informationUrl": "https://go.microsoft.com/fwlink/?linkid=832347",
    "inputDescriptors": [
        {
            "id": "teamsUrl",
            "name": "Connector URL",
            "description": "The Microsoft Teams connector URL to post the message to",
            "inputMode": "textbox",
            "isConfidential": false,
            "useInDefaultDescription": true,
            "validation" : {
                "isRequired": true,
                "dataType": "uri"
            }
        }
    ], 
    "actions": [
        {
            "id": "postMessageToTeam",
            "name": "Post a message to a channel",
            "description": "Post a message with details about the event to a channel. <a href='https://go.microsoft.com/fwlink/?linkid=832347'>Learn more</a>",
            "supportedEventTypes": [ "*" ],
            "supportedResourceVersions": {
                "workitem.created": [ "3.1-preview.3" ],
                "workitem.updated": [ "3.1-preview.3" ],
                "workitem.commented": [ "3.1-preview.3" ],
                "workitem.deleted": [ "3.1-preview.3" ],
                "workitem.restored": [ "3.1-preview.3" ]
            },
            "publishEvent": {
                "url": "{{{teamsUrl}}}",
                "resourceDetailsToSend": "all",
              "transforms": [
                {
                  "eventType": "build.complete",
                  "templateAssetType": "BuildCompleteTransform.hbs"
                },
                {
                  "eventType": "git.pullrequest.created",
                  "templateAssetType": "PullRequestCreatedTemplate.hbs"
                },
                {
                  "eventType": "git.pullrequest.merged",
                  "templateAssetType": "PullRequestMergedTemplate.hbs"
                },
                {
                  "eventType": "git.pullrequest.updated",
                  "templateAssetType": "PullRequestUpdatedTemplate.hbs"
                },
                {
                  "eventType": "workitem.commented",
                  "templateAssetType": "WorkItemCommentedTransform.hbs"
                },
                {
                  "eventType": "workitem.created",
                  "templateAssetType": "WorkItemCreatedTransform.hbs"
                },
                {
                  "eventType": "workitem.deleted",
                  "templateAssetType": "WorkItemDeletedTransform.hbs"
                },
                {
                  "eventType": "workitem.restored",
                  "templateAssetType": "WorkItemRestoredTransform.hbs"
                },
                {
                  "eventType": "workitem.updated",
                  "templateAssetType": "WorkItemUpdatedTransform.hbs"
                },
                {
                  "eventType": "git.push",
                  "templateAssetType": "CommitsPushedTransform.hbs"
                },
                {
                  "eventType": "tfvc.checkin",
                  "templateAssetType": "CodeCheckedInTransform.hbs"
                },
                {
                  "eventType": "message.posted",
                  "templateAssetType": "MessagePostedTransform.hbs"
                },
                {
                  "eventType": "ms.vss-release.release-created-event",
                  "templateAssetType": "ReleaseCreatedTemplate.hbs"
                },
                {
                  "eventType": "ms.vss-release.release-abandoned-event",
                  "templateAssetType": "ReleaseAbandonedTemplate.hbs"
                },
                {
                  "eventType": "ms.vss-release.deployment-approval-pending-event",
                  "templateAssetType": "DeploymentApprovalPendingTemplate.hbs"
                },
                {
                  "eventType": "ms.vss-release.deployment-approval-completed-event",
                  "templateAssetType": "DeploymentApprovalCompletedTemplate.hbs"
                },
                {
                  "eventType": "ms.vss-release.deployment-started-event",
                  "templateAssetType": "DeploymentStartedTemplate.hbs"
                },
                {
                  "eventType": "ms.vss-release.deployment-completed-event",
                  "templateAssetType": "DeploymentCompletedTemplate.hbs"
                },
                {
                  "eventType": "ms.vss-pipelines.stage-state-changed-event",
                  "templateAssetType": "RunStateChange.hbs"
                },
                {
                  "eventType": "ms.vss-pipelinechecks-events.approval-completed",
                  "templateAssetType": "RunStageApproved.hbs"
                },
                {
                  "eventType": "ms.vss-pipelinechecks-events.approval-pending",
                  "templateAssetType": "RunStageWaitingApproval.hbs"
                },
                {
                  "eventType": "ms.vss-pipelines.run-state-changed-event",
                  "templateAssetType": "RunStateChange.hbs"
                }
              ]
            }
        }
    ]
}