{
    "id": "AzureCloud",
    "name": "Azure Cloud Services",
    "description": "Build, package, test, and deploy an Azure Cloud Service.",
    "category": "Deployment",
    "defaultHostedQueue": "Hosted Windows 2019 with VS 2019",
    "iconTaskId": "2CA8FE15-42EA-4B26-80F1-E0738EC17E89",
    "template": {
        "buildNumberFormat": "$(date:yyyyMMdd)$(rev:.r)",
        "process": {
            "type": 1,
            "phases": [
                {
                    "steps": [
                        {
                            "enabled": true,
                            "displayName": "Use NuGet 4.4.1",
                            "task": {
                                "id": "2c65196a-54fd-4a02-9be8-d9d1837b7c5d",
                                "versionSpec": "0.*",
                                "definitionType": "task"
                            },
                            "inputs": {
                                "versionSpec": "4.4.1",
                                "checkLatest": "false"
                            }
                        },
                        {
                            "enabled": true,
                            "inputs": {
                                "command": "restore",
                                "solution": "$(Parameters.solution)",
                                "selectOrConfig": "select",
                                "includeNuGetOrg": "true"
                            },
                            "task": {
                                "id": "333b11bd-d341-40d9-afcf-b32d5ce6f23b",
                                "versionSpec": "2.*"
                            }
                        },
                        {
                            "enabled": true,
                            "inputs": {
                                "solution": "$(Parameters.solution)",
                                "platform": "$(BuildPlatform)",
                                "configuration": "$(BuildConfiguration)",
                                "restoreNugetPackages": "false"
                            },
                            "task": {
                                "id": "71a9a2d3-a98a-4caa-96ab-affca411ecda",
                                "versionSpec": "1.*"
                            }
                        },
                        {
                            "enabled": true,
                            "inputs": {
                                "solution": "$(Parameters.CloudServiceProject)",
                                "msbuildArgs": "/t:Publish /p:TargetProfile=$(targetProfile) /p:DebugType=None /p:SkipInvalidConfigurations=true /p:OutputPath=bin\\ /p:PublishDir=\"$(build.artifactstagingdirectory)\\\\\"",
                                "platform": "$(BuildPlatform)",
                                "configuration": "$(BuildConfiguration)",
                                "restoreNugetPackages": "false"
                            },
                            "task": {
                                "id": "71a9a2d3-a98a-4caa-96ab-affca411ecda",
                                "versionSpec": "1.*"
                            }
                        },
                        {
                            "enabled": true,
                            "inputs": {
                                "testAssemblyVer2": "**\\$(BuildConfiguration)\\*test*.dll\n!**\\obj\\**",
                                "platform": "$(BuildPlatform)",
                                "configuration": "$(BuildConfiguration)"
                            },
                            "task": {
                                "id": "ef087383-ee5e-42c7-9a53-ab56c98420f9",
                                "versionSpec": "2.*"
                            }
                        },
                        {
                            "enabled": true,
                            "inputs": {
                                "CsPkg": "$(build.artifactstagingdirectory)\\*.cspkg",
                                "CsCfg": "$(build.artifactstagingdirectory)\\*.cscfg",
                                "DeploymentLabel": "$(Build.BuildNumber)",
                                "ConnectedServiceName": "$(Parameters.ConnectedServiceName)",
                                "StorageAccount": "$(Parameters.StorageAccount)",
                                "ServiceName": "$(Parameters.ServiceName)",
                                "ServiceLocation": "$(Parameters.ServiceLocation)"
                            },
                            "task": {
                                "id": "2ca8fe15-42ea-4b26-80f1-e0738ec17e89",
                                "versionSpec": "1.*"
                            }
                        },
                        {
                            "enabled": true,
                            "continueOnError": true,
                            "inputs": {
                                "SearchPattern": "**\\bin\\**\\*.pdb",
                                "SymbolsArtifactName": "Symbols_$(BuildConfiguration)",
                                "SymbolServerType": "TeamServices",
                                "PublishSymbols": "false"
                            },
                            "task": {
                                "id": "0675668a-7bba-4ccb-901d-5ad6554ca653",
                                "versionSpec": "2.*"
                            }
                        },
                        {
                            "enabled": true,
                            "alwaysRun": true,
                            "inputs": {
                                "PathtoPublish": "$(build.artifactstagingdirectory)",
                                "ArtifactName": "drop",
                                "ArtifactType": "Container",
                                "TargetPath": "\\\\my\\share\\$(Build.DefinitionName)\\$(Build.BuildNumber)"
                            },
                            "task": {
                                "id": "2ff763a7-ce83-4e1f-bc89-0ae63477cebe",
                                "versionSpec": "1.*"
                            }
                        }
                    ]
                }
            ]
        },
        "options": [
            {
                "definition": {
                    "id": "5D58CC01-7C75-450C-BE18-A388DDB129EC"
                },
                "enabled": true,
                "inputs": {
                }
            }
        ],
        "variables": {
            "system.debug": {
                "value": "false",
                "allowOverride": true
            },
            "BuildConfiguration": {
                "value": "release",
                "allowOverride": true
            },
            "BuildPlatform": {
                "value": "any cpu",
                "allowOverride": true
            },
            "targetProfile": {
                "value": "Cloud",
                "allowOverride": true
            }
        },
        "triggers": [
            {
                "triggerType": "continuousIntegration",
                "batchChanges": false,
                "branchFilters": []
            }
        ],
        "processParameters": {
            "inputs": [
                {
                    "options": {},
                    "properties": {},
                    "name": "solution",
                    "label": "{SolutionLabel}",
                    "defaultValue": "**\\*.sln",
                    "required": true,
                    "type": "filePath",
                    "helpMarkDown": "{SolutionDescription}",
                    "visibleRule": "",
                    "groupName": ""
                },
                {
                    "options": {},
                    "properties": {},
                    "name": "CloudServiceProject",
                    "label": "{CloudServiceProjectLabel}",
                    "defaultValue": "**\\*.ccproj",
                    "required": true,
                    "type": "filePath",
                    "helpMarkDown": "{CloudServiceProjectDescription}",
                    "visibleRule": "",
                    "groupName": ""
                },
                {
                    "options": {},
                    "properties": {},
                    "name": "ConnectedServiceName",
                    "label": "{ConnectedServiceNameLabel}",
                    "defaultValue": "",
                    "required": true,
                    "type": "connectedService:Azure:Certificate,UsernamePassword",
                    "helpMarkDown": "{ConnectedServiceDescription}",
                    "visibleRule": "",
                    "groupName": ""
                },
                {
                    "options": {},
                    "properties": {
                        "EditableOptions": "True"
                    },
                    "name": "StorageAccount",
                    "label": "{StorageAccountLabel}",
                    "defaultValue": "",
                    "required": true,
                    "type": "pickList",
                    "helpMarkDown": "{StorageAccountDescription}",
                    "visibleRule": "",
                    "groupName": ""
                },
                {
                    "options": {},
                    "properties": {
                        "EditableOptions": "True"
                    },
                    "name": "ServiceName",
                    "label": "{ServiceNameLabel}",
                    "defaultValue": "",
                    "required": true,
                    "type": "pickList",
                    "helpMarkDown": "{SeviceNameDescription}",
                    "visibleRule": "",
                    "groupName": ""
                },
                {
                    "options": {},
                    "properties": {
                        "EditableOptions": "True"
                    },
                    "name": "ServiceLocation",
                    "label": "{ServiceLocationLabel}",
                    "defaultValue": "",
                    "required": true,
                    "type": "pickList",
                    "helpMarkDown": "{ServiceLocationDescription}",
                    "visibleRule": "",
                    "groupName": ""
                }
            ],
            "dataSourceBindings": [
                {
                    "dataSourceName": "AzureStorageServiceNames",
                    "parameters": {},
                    "endpointId": "$(ConnectedServiceName)",
                    "target": "StorageAccount"
                },
                {
                    "dataSourceName": "AzureHostedServiceNames",
                    "parameters": {},
                    "endpointId": "$(ConnectedServiceName)",
                    "target": "ServiceName"
                },
                {
                    "dataSourceName": "AzureLocations",
                    "parameters": {},
                    "endpointId": "$(ConnectedServiceName)",
                    "target": "ServiceLocation"
                }
            ]
        }
    }
}